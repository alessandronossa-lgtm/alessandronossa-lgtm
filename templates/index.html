<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PromptSheet — Gere sua planilha</title>
    <style>
      body{
        font-family: Arial,Helvetica,sans-serif;
        display:flex;
        align-items:center;
        justify-content:center;
        height:100vh;
        margin:0;
        background:#f6f9f7
      }
      .card{
        background:white;
        padding:28px;
        border-radius:10px;
        box-shadow:0 6px 24px rgba(0,0,0,0.08);
        width:420px
      }
      textarea{
        width:100%;
        height:140px;
        padding:10px;
        border-radius:6px;
        border:1px solid #ddd;
        resize:vertical
      }
      button{
        margin-top:12px;
        padding:10px 16px;
        border-radius:8px;
        border:0;
        background:#217346;
        color:white;
        font-weight:600;
        cursor:pointer
      }
      p.note{
        font-size:13px;
        color:#666
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h2>PromptSheet — Gere sua planilha</h2>
      <form action="/generate" method="post">
        <label for="description">Descreva o que precisa:</label>
        <textarea id="description" name="description" placeholder="Ex.: Controle de vendas com data, cliente, produto, quantidade e total"></textarea>
        <button type="submit">Gerar .xlsx</button>
      </form>
      <p class="note">Exemplos: controle de vendas, inventário, fluxo de caixa.</p>
    </div>
  </body>

<script>
document.getElementById("form").addEventListener("submit", async function(e) {
    e.preventDefault();

    const descricao = document.getElementById("descricao").value;

    const formData = new FormData();
    formData.append("descricao", descricao);

    const response = await fetch("https://<SEU-RENDER-URL>/gerar", {
        method: "POST",
        body: formData
    });

    const blob = await response.blob();
    const url = window.URL.createObjectURL(blob);
    const link = document.createElement("a");

    link.href = url;
    link.download = "planilha_gerada.xlsx";
    link.click();
});
</script>

  
</html>
